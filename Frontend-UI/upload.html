<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Upload Product Ticket</title>
    <link rel="stylesheet" href="./css/styles.css" />
</head>
<body class="upload-page">
<div class="upload-wrapper">
    <div class="upload-card">
        <div class="icon-wrapper">
            <!-- Inline SVG Icon -->
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none">
                <path d="M4 6h16v2a2 2 0 100 4 2 2 0 100 4v2H4v-2a2 2 0 100-4 2 2 0 100-4V6z" stroke="#B5FFB0" stroke-width="2"/>
            </svg>
        </div>
        <h2>Upload Product Ticket</h2>
        <form id="upload-form" enctype="multipart/form-data">
            <div class="upload-zone">
                <label for="barcode">Product Barcode:</label>
                <input type="text" name="barcode" id="barcode" placeholder="Enter product barcode" required>
            </div>
            <div class="upload-zone">
                <label for="barcodeImage">Barcode Image:</label>
                <input type="file" accept="image/*" name="barcodeImage" capture="environment" required>
            </div>
            <div class="upload-zone">
                <label for="frontImage">Product Front Image:</label>
                <input type="file" accept="image/*" name="frontImage" capture="environment" required>
            </div>
            <button type="submit" class="upload-submit-btn">Submit Ticket</button>
            <div id="upload-status" class="status-text"></div>
        </form>
    </div>
</div>
<script src="js/config.js"></script>
<script>
    const API_BASE_URL = window._env_.API_BASE_URL;
    document.getElementById('upload-form').addEventListener('submit', async function (e) {
        e.preventDefault();
        const form = e.target;
        const formData = new FormData(form);
        const status = document.getElementById('upload-status');
        status.textContent = 'Uploading...';
        try {
            const response = await fetch(`${API_BASE_URL}/api/tickets/upload`, {
                method: 'POST',
                body: formData
            });
            const result = await response.text();
            status.textContent = response.ok ? '✅ Success: ' + result : '❌ Error: ' + result;
        } catch (err) {
            status.textContent = '❌ Failed: ' + err.message;
        }
    });
</script>
</body>
</html>
